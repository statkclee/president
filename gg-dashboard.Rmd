---
title: "제8회 지선"
output: 
  flexdashboard::flex_dashboard:
  orientation: rows
vertical_layout: fill
theme: lumen
logo: fig/Flag_of_South_Korea.png
css: css/minju.css
includes:
  in_header: google_analytics.html
editor_options: 
  chunk_output_type: console
---
  
  
```{r setup, include=FALSE}
## 0. R 마크다운 환경설정 ------
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE,
                      comment="", digits = 3, tidy = FALSE, prompt = FALSE, fig.align = 'center')
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
options(knitr.duplicate.label = 'allow')
## 0. R 팩키지 ------
library(flexdashboard)
library(tidyverse)
library(janitor)
library(extrafont)
loadfonts()
library(here)
library(fs)
library(glue)
library(gt)
library(plotly)

library(tidygraph)
library(ggraph)
library(patchwork)
library(ggforce)

```


<!-- ```{r child="dashboard/local/world.Rmd", encoding="UTF-8"} -->
<!-- ``` -->


<!-- ```{r child="dashboard/local/document.Rmd", encoding="UTF-8"} -->
<!-- ``` -->


구시군 득표 {data-icon="ion-stats-bars"}
=====================================  

Column {data-width=200}
-------------------------------------

### 구시군


```{r crosstalk-cs}
# https://nicar.r-journalism.com/docs/crosstalk-flexdashboard-leaflet-datatable/
  
library(crosstalk)
library(leaflet)
library(DT)
library(d3scatter)

gg_raw <- read_rds("data/gg_raw.rds")


shared_gg <- SharedData$new(gg_raw)

filter_checkbox(
  id = "선거",
  label = "선거",
  sharedData = shared_gg,
  group = ~선거
)

filter_select(
  id = "구시군명",
  label = "구시군명",
  sharedData = shared_gg,
  group = ~구시군명
)

filter_checkbox(
  id = "정당",
  label = "정당",
  sharedData = shared_gg,
  group = ~정당
)

filter_slider(
  id = "득표수",
  label = "득표수",
  sharedData = shared_gg,
  column = "득표수",
  step = 1000,
  round = TRUE,
  sep = "",
  min = 0,
  ticks = FALSE
)

```


Column {data-width=800}
-------------------------------------

### 표

```{r}

shared_gg %>% 
  DT::datatable() %>% 
  DT::formatRound("득표수", digits =0)
```


### 지도


```{r}

shared_gg %>% 
  leaflet() %>% 
  addTiles() %>% 
  setView(  lng=127.063, lat=37.513, zoom = 8) # korea, zoom 6


```





